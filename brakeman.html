<!DOCTYPE HTML SYSTEM>
<html>
<head>
<title>Brakeman Report</title>
  <script>
    function toggle(context) {
      var elem = document.getElementById(context);

      if (elem.style.display != "block")
        elem.style.display = "block";
      else
        elem.style.display = "none";
        
      elem.parentNode.scrollIntoView();
    }
  </script>
  <style>
    /* CSS style used for HTML reports */

body {
  font-family: sans-serif;
  color: #161616;
}

p {
  font-weight: bold;
  font-size: 11pt;
  color: #2D0200;
 }

 th {
   background-color: #980905;
   border-bottom: 5px solid #530200;
   color: white;
   font-size: 11pt;
   padding: 1px 8px 1px 8px;
 }

 td {
   border-bottom: 2px solid white;
   font-family: monospace;
   padding: 5px 8px 1px 8px;
 }

 table {
   background-color: #FCF4D4;
   border-collapse: collapse;
 }

 h1 {
   color: #2D0200;
   font-size: 14pt;
 }

 h2 {
   color: #2D0200;
   font-size: 12pt;
 }

 span.high-confidence {
   font-weight:bold;
   color: red;
 }

 span.med-confidence {
 }

 span.weak-confidence {
   color:gray;
 }

 div.warning_message {
   cursor: pointer;
 }

 div.warning_message:hover {
   background-color: white;
 }

 table caption {
   background-color: #FFE;
   padding: 2px;
 }

 table.context {
   margin-top: 5px;
   margin-bottom: 5px;
   border-left: 1px solid #90e960;
   color: #212121;
 }

 tr.context {
   background-color: white;
 }

 tr.first {
   border-top: 1px solid #7ecc54;
   padding-top: 2px;
 }

 tr.error {
  background-color: #f4c1c1 !important
 }

 tr.near_error {
  background-color: #f4d4d4 !important
 }

 tr.alt {
   background-color: #e8f4d4;
 }

 td.context {
   padding: 2px 10px 0px 6px;
   border-bottom: none;
 }

 td.context_line {
   padding: 2px 8px 0px 7px;
   border-right: 1px solid #b3bda4;
   border-bottom: none;
   color: #6e7465;
 }

 pre.context {
   margin-bottom: 1px;
 }

 .user_input {
   background-color: #fcecab;
 }

  </style>
</head>
<body>

<h1>Brakeman Report</h1>
<table>
  <tr>
    <th>Application Path</th>
    <th>Rails Version</th>
    <th>Report Generation Time</th>
    <th>Checks Performed</th>
  </tr>
  <tr>
    <td>C:/Users/Ed/webapps/creditflex</td>
    <td>3.2.3</td>
    <td>2012-06-19 13:44:11 -0400</td>
    <td>BasicAuth, CrossSiteScripting, DefaultRoutes, EscapeFunction, Evaluation, Execute, FileAccess, FilterSkipping, ForgerySetting, LinkTo, LinkToHref, MailTo, MassAssignment, ModelAttributes, NestedAttributes, QuoteTableName, Redirect, Render, ResponseSplitting, SQL, SafeBufferManipulation, SelectVulnerability, Send, SendFile, SessionSettings, SkipBeforeFilter, StripTags, TranslateBug, ValidationRegex, WithoutProtection</td>
  </tr>
</table>
<br>
<h2 id='summary'>Summary</h2> 
<table>
  <tr>
    <th>Scanned/Reported</th>
    <th>Total</th>
  </tr>
  <tr>
    <td>Controllers</td>
    <td>18</td>
  </tr>
  <tr>
    <td>Models</td>
    <td>19</td>
  </tr>
  <tr>
    <td>Templates</td>
    <td>92</td>
  </tr>
  <tr>
    <td>Errors</td>
    <td>1</td>
  </tr>
  <tr>
    <td>Security Warnings</td>
    <td>38 <span class='high-confidence'>(38)</span></td>
  </tr>
</table>
<br>
<table>
  <tr>
    <th>Warning Type</th>
    <th>Total</th>
  </tr>
  
  <tr>
    <td>Attribute Restriction</td>
    <td>1</td>
  </tr>
  
  <tr>
    <td>Format Validation</td>
    <td>2</td>
  </tr>
  
  <tr>
    <td>Mass Assignment</td>
    <td>31</td>
  </tr>
  
  <tr>
    <td>Redirect</td>
    <td>1</td>
  </tr>
  
  <tr>
    <td>SQL Injection</td>
    <td>3</td>
  </tr>
  
</table>
<br>
<div onClick="toggle('errors_table');">  <h2>Exceptions raised during the analysis (click to see them)</h2 ></div> <div id='errors_table' style='display:none'> 
<table>
  <tr>
    <th>Error</th>
    <th>Location</th>
  </tr>

  <tr>
    <td> parse error on value &quot;)&quot; (tRPAREN)</td>
    <td>could not parse C:/Users/Ed/webapps/creditflex/app/views/lycee/index.html.erb</td>
  </tr>

</table>
</div>
<h2>Security Warnings</h2>  
<table>

  <tr>
    <th>Confidence</th>
    <th>Class</th>
    <th>Method</th>
    <th>Warning Type</th>
    <th>Message</th>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CommentsController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context1');toggle('message1');toggle('full_message1')" >Unprotected mass assignment near line 43: Comment.new(<span class="user_input">params[:comment]</span>)<table id='context1' class='context' style='display:none'><caption>/app/controllers/comments_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>38</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /comments</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /comments.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @comment = Comment.new(params[:comment])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @comment.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to :back, notice: 'Comment was successfully created.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @comment, status: :created, location: @comment }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CommentsController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context18');toggle('message18');toggle('full_message18')" ><span id='message18' style='display:block' >Unprotected mass assignment near line 62: Comment.find(params[:id]).update_attributes(params[:comment...</span><span id='full_message18' style='display:none'>Unprotected mass assignment near line 62: Comment.find(params[:id]).update_attributes(<span class="user_input">params[:comment]</span>)</span><table id='context18' class='context' style='display:none'><caption>/app/controllers/comments_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>57</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /comments/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @comment = Comment.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @comment.update_attributes(params[:comment])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @comment, notice: 'Comment was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :no_content }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @comment.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CoursesController</td>
    <td>add_response</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context2');toggle('message2');toggle('full_message2')" >Unprotected mass assignment near line 26: Response.new(<span class="user_input">params[:response]</span>)<table id='context2' class='context' style='display:none'><caption>/app/controllers/courses_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>21</pre>
          </td>
          <td class='context'>
            <pre class='context'>	  format.html </pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def add_response</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @response = Response.new(params[:response])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>	@response.user_id = current_user.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>	@response.course_id = params[:id]</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :partial =&gt;  # new.html.erb</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>      format.json { render json: @request }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CoursesController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context3');toggle('message3');toggle('full_message3')" >Unprotected mass assignment near line 72: Course.new(<span class="user_input">params[:course]</span>)<table id='context3' class='context' style='display:none'><caption>/app/controllers/courses_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>67</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /courses</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /courses.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @course = Course.new(params[:course])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @course.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>	  UserMailer.activity_email(User.where( :username =&gt; 'EdJones').first).deliver</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @course, notice: 'Course was successfully created.' }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CoursesController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context19');toggle('message19');toggle('full_message19')" ><span id='message19' style='display:block' >Unprotected mass assignment near line 92: Course.find(params[:id]).update_attributes(<span class="user_input">params[:course]</span>)...</span><span id='full_message19' style='display:none'>Unprotected mass assignment near line 92: Course.find(params[:id]).update_attributes(<span class="user_input">params[:course]</span>)</span><table id='context19' class='context' style='display:none'><caption>/app/controllers/courses_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>87</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /courses/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>89</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @course = Course.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>91</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @course.update_attributes(params[:course])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>93</pre>
            </td>
            <td class='context'>
              <pre class='context'>	    UserMailer.activity_email(User.where( :username =&gt; 'EdJones').first).deliver</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @course, notice: 'Course was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>95</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>PortfoliosController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context4');toggle('message4');toggle('full_message4')" >Unprotected mass assignment near line 43: Portfolio.new(<span class="user_input">params[:portfolio]</span>)<table id='context4' class='context' style='display:none'><caption>/app/controllers/portfolios_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>38</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /portfolios</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /portfolios.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @portfolio = Portfolio.new(params[:portfolio])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @portfolio.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @portfolio, notice: 'Portfolio was successfully created.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @portfolio, status: :created, location: @portfolio }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>PortfoliosController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context20');toggle('message20');toggle('full_message20')" ><span id='message20' style='display:block' >Unprotected mass assignment near line 62: Portfolio.find(params[:id]).update_attributes(params[:portf...</span><span id='full_message20' style='display:none'>Unprotected mass assignment near line 62: Portfolio.find(params[:id]).update_attributes(<span class="user_input">params[:portfolio]</span>)</span><table id='context20' class='context' style='display:none'><caption>/app/controllers/portfolios_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>57</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /portfolios/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @portfolio = Portfolio.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @portfolio.update_attributes(params[:portfolio])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @portfolio, notice: 'Portfolio was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :ok }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @portfolio.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ProjectsController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context5');toggle('message5');toggle('full_message5')" >Unprotected mass assignment near line 45: Project.new(<span class="user_input">params[:project]</span>)<table id='context5' class='context' style='display:none'><caption>/app/controllers/projects_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>40</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /projects</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /projects.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @project = Project.new(params[:project])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @project.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>	    UserMailer.activity_email(User.where( :username =&gt; 'EdJones').first).deliver</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @project, notice: 'Project was successfully created.' }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ProjectsController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context21');toggle('message21');toggle('full_message21')" ><span id='message21' style='display:block' >Unprotected mass assignment near line 65: Project.find(params[:id]).update_attributes(params[:project...</span><span id='full_message21' style='display:none'>Unprotected mass assignment near line 65: Project.find(params[:id]).update_attributes(<span class="user_input">params[:project]</span>)</span><table id='context21' class='context' style='display:none'><caption>/app/controllers/projects_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>60</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /projects/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @project = Project.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @project.update_attributes(params[:project])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>	    UserMailer.activity_email(User.where( :username =&gt; 'EdJones').first).deliver</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @project, notice: 'Project was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ProposalStatusesController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context6');toggle('message6');toggle('full_message6')" >Unprotected mass assignment near line 43: ProposalStatus.new(<span class="user_input">params[:proposal_status]</span>)<table id='context6' class='context' style='display:none'><caption>/app/controllers/proposal_statuses_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>38</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /proposal_statuses</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /proposal_statuses.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @proposal_status = ProposalStatus.new(params[:proposal_status])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @proposal_status.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @proposal_status, notice: 'Proposal status was successfully created.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @proposal_status, status: :created, location: @proposal_status }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ProposalStatusesController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context22');toggle('message22');toggle('full_message22')" ><span id='message22' style='display:block' >Unprotected mass assignment near line 62: ProposalStatus.find(params[:id]).update_attributes(params[:...</span><span id='full_message22' style='display:none'>Unprotected mass assignment near line 62: ProposalStatus.find(params[:id]).update_attributes(<span class="user_input">params[:proposal_status]</span>)</span><table id='context22' class='context' style='display:none'><caption>/app/controllers/proposal_statuses_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>57</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /proposal_statuses/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @proposal_status = ProposalStatus.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @proposal_status.update_attributes(params[:proposal_status])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @proposal_status, notice: 'Proposal status was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :ok }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @proposal_status.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ProposalTypesController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context7');toggle('message7');toggle('full_message7')" >Unprotected mass assignment near line 43: ProposalType.new(<span class="user_input">params[:proposal_type]</span>)<table id='context7' class='context' style='display:none'><caption>/app/controllers/proposal_types_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>38</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /proposal_types</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /proposal_types.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @proposal_type = ProposalType.new(params[:proposal_type])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>	@proposal_types = ProposalType.all</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @proposal_type.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @proposal_type, notice: 'Proposal type was successfully created.' }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ProposalTypesController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context23');toggle('message23');toggle('full_message23')" ><span id='message23' style='display:block' >Unprotected mass assignment near line 63: ProposalType.find(params[:id]).update_attributes(params[:pr...</span><span id='full_message23' style='display:none'>Unprotected mass assignment near line 63: ProposalType.find(params[:id]).update_attributes(<span class="user_input">params[:proposal_type]</span>)</span><table id='context23' class='context' style='display:none'><caption>/app/controllers/proposal_types_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>58</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /proposal_types/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @proposal_type = ProposalType.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @proposal_type.update_attributes(params[:proposal_type])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @proposal_type, notice: 'Proposal type was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :ok }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @proposal_type.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ProposalsController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context8');toggle('message8');toggle('full_message8')" >Unprotected mass assignment near line 43: Proposal.new(<span class="user_input">params[:proposal]</span>)<table id='context8' class='context' style='display:none'><caption>/app/controllers/proposals_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>38</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /proposals</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /proposals.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @proposal = Proposal.new(params[:proposal])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @proposal.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @proposal, notice: 'Proposal was successfully created.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @proposal, status: :created, location: @proposal }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ProposalsController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context24');toggle('message24');toggle('full_message24')" ><span id='message24' style='display:block' >Unprotected mass assignment near line 62: Proposal.find(params[:id]).update_attributes(params[:propos...</span><span id='full_message24' style='display:none'>Unprotected mass assignment near line 62: Proposal.find(params[:id]).update_attributes(<span class="user_input">params[:proposal]</span>)</span><table id='context24' class='context' style='display:none'><caption>/app/controllers/proposals_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>57</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /proposals/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @proposal = Proposal.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @proposal.update_attributes(params[:proposal])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @proposal, notice: 'Proposal was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :ok }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @proposal.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>RequestsController</td>
    <td>add_response</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context9');toggle('message9');toggle('full_message9')" >Unprotected mass assignment near line 7: Response.new(<span class="user_input">params[:response]</span>)<table id='context9' class='context' style='display:none'><caption>/app/controllers/requests_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>before_filter :require_login, :only =&gt; [:add_response, :create]</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def add_response</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @response = Response.new(params[:response])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>	@response.user_id = current_user.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>	@response.request_id = params[:id]</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :partial =&gt;  # new.html.erb</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>	  format.js</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>RequestsController</td>
    <td>show</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context10');toggle('message10');toggle('full_message10')" >Unprotected mass assignment near line 38: Response.new(<span class="user_input">params[:response]</span>)<table id='context10' class='context' style='display:none'><caption>/app/controllers/requests_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>33</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # GET /requests/1</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # GET /requests/1.json</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def show</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @request = Request.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>	@responses = Response.where(:request_id =&gt; params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>	@response_new = Response.new(params[:response])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>	if current_user </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>	then @response_new.user_id = current_user.id </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>	else </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>	@response_new.user_id = 8 </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>	end </pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>RequestsController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context11');toggle('message11');toggle('full_message11')" >Unprotected mass assignment near line 87: Request.new(<span class="user_input">params[:request]</span>)<table id='context11' class='context' style='display:none'><caption>/app/controllers/requests_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>82</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /requests</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /requests.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @request = Request.new(params[:request])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>#raise(params[:request])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>89</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @request.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>91</pre>
            </td>
            <td class='context'>
              <pre class='context'>	  UserMailer.activity_email(User.where( :username =&gt; 'EdJones').first).deliver</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @request, notice: 'Request was successfully created.' }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>RequestsController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context25');toggle('message25');toggle('full_message25')" ><span id='message25' style='display:block' >Unprotected mass assignment near line 107: Request.find(params[:id]).update_attributes(params[:reques...</span><span id='full_message25' style='display:none'>Unprotected mass assignment near line 107: Request.find(params[:id]).update_attributes(<span class="user_input">params[:request]</span>)</span><table id='context25' class='context' style='display:none'><caption>/app/controllers/requests_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>102</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /requests/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>104</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @request = Request.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>106</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>107</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @request.update_attributes(params[:request])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>108</pre>
            </td>
            <td class='context'>
              <pre class='context'>	  UserMailer.activity_email(User.where( :username =&gt; 'EdJones').first).deliver</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>109</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @request, notice: 'Request was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>110</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>112</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ResourcesController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context12');toggle('message12');toggle('full_message12')" >Unprotected mass assignment near line 43: Resource.new(<span class="user_input">params[:resource]</span>)<table id='context12' class='context' style='display:none'><caption>/app/controllers/resources_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>38</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /resources</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /resources.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @resource = Resource.new(params[:resource])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>	@resource.user_id = current_user.id if current_user else 8</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @resource.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @resource, notice: 'Resource was successfully created.' }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @resource, status: :created, location: @resource }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ResourcesController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context26');toggle('message26');toggle('full_message26')" ><span id='message26' style='display:block' >Unprotected mass assignment near line 62: Resource.find(params[:id]).update_attributes(params[:resour...</span><span id='full_message26' style='display:none'>Unprotected mass assignment near line 62: Resource.find(params[:id]).update_attributes(<span class="user_input">params[:resource]</span>)</span><table id='context26' class='context' style='display:none'><caption>/app/controllers/resources_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>57</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /resources/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @resource = Resource.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @resource.update_attributes(params[:resource])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @resource, notice: 'Resource was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :ok }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @resource.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ResponsesController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context13');toggle('message13');toggle('full_message13')" >Unprotected mass assignment near line 44: Response.new(<span class="user_input">params[:response]</span>)<table id='context13' class='context' style='display:none'><caption>/app/controllers/responses_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>39</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /responses</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /responses.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @response = Response.new(params[:response])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>	@request = Request.where(:id =&gt; params[:response][:request_id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>	logger.debug &quot;@request: #{@request.inspect}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @response.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @response.request, notice: 'Response was successfully created.' }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ResponsesController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context27');toggle('message27');toggle('full_message27')" ><span id='message27' style='display:block' >Unprotected mass assignment near line 64: Response.find(params[:id]).update_attributes(params[:respon...</span><span id='full_message27' style='display:none'>Unprotected mass assignment near line 64: Response.find(params[:id]).update_attributes(<span class="user_input">params[:response]</span>)</span><table id='context27' class='context' style='display:none'><caption>/app/controllers/responses_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>59</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /responses/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @response = Response.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @response.update_attributes(params[:response])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @response, notice: 'Response was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :ok }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @response.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>StudentsController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context14');toggle('message14');toggle('full_message14')" >Unprotected mass assignment near line 43: Student.new(<span class="user_input">params[:student]</span>)<table id='context14' class='context' style='display:none'><caption>/app/controllers/students_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>38</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /students</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /students.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @student = Student.new(params[:student])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @student.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @student, notice: 'Student was successfully created.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @student, status: :created, location: @student }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>StudentsController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context28');toggle('message28');toggle('full_message28')" ><span id='message28' style='display:block' >Unprotected mass assignment near line 62: Student.find(params[:id]).update_attributes(params[:student...</span><span id='full_message28' style='display:none'>Unprotected mass assignment near line 62: Student.find(params[:id]).update_attributes(<span class="user_input">params[:student]</span>)</span><table id='context28' class='context' style='display:none'><caption>/app/controllers/students_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>57</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /students/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @student = Student.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @student.update_attributes(params[:student])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @student, notice: 'Student was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :ok }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @student.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>SubjectsController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context15');toggle('message15');toggle('full_message15')" >Unprotected mass assignment near line 44: Subject.new(<span class="user_input">params[:subject]</span>)<table id='context15' class='context' style='display:none'><caption>/app/controllers/subjects_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>39</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /subjects</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /subjects.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @subject = Subject.new(params[:subject])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @subject.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @subject, notice: 'Subject was successfully created.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @subject, status: :created, location: @subject }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>SubjectsController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context29');toggle('message29');toggle('full_message29')" ><span id='message29' style='display:block' >Unprotected mass assignment near line 63: Subject.find(params[:id]).update_attributes(params[:subject...</span><span id='full_message29' style='display:none'>Unprotected mass assignment near line 63: Subject.find(params[:id]).update_attributes(<span class="user_input">params[:subject]</span>)</span><table id='context29' class='context' style='display:none'><caption>/app/controllers/subjects_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>58</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /subjects/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @subject = Subject.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @subject.update_attributes(params[:subject])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @subject, notice: 'Subject was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :ok }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @subject.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>TeachersController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context16');toggle('message16');toggle('full_message16')" >Unprotected mass assignment near line 45: Teacher.new(<span class="user_input">params[:teacher]</span>)<table id='context16' class='context' style='display:none'><caption>/app/controllers/teachers_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>40</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /teachers</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /teachers.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @teacher = Teacher.new(params[:teacher])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @teacher.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @teacher, notice: 'Teacher was successfully created.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @teacher, status: :created, location: @teacher }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>TeachersController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context30');toggle('message30');toggle('full_message30')" ><span id='message30' style='display:block' >Unprotected mass assignment near line 64: Teacher.find(params[:id]).update_attributes(params[:teacher...</span><span id='full_message30' style='display:none'>Unprotected mass assignment near line 64: Teacher.find(params[:id]).update_attributes(<span class="user_input">params[:teacher]</span>)</span><table id='context30' class='context' style='display:none'><caption>/app/controllers/teachers_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>59</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /teachers/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @teacher = Teacher.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @teacher.update_attributes(params[:teacher])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @teacher, notice: 'Teacher was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :ok }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @teacher.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>UsersController</td>
    <td>create</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context17');toggle('message17');toggle('full_message17')" >Unprotected mass assignment near line 50: User.new(<span class="user_input">params[:user]</span>)<table id='context17' class='context' style='display:none'><caption>/app/controllers/users_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>45</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /users</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /users.json</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @user = User.new(params[:user])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @user.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>	   auto_login(@user)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to :root, notice: 'User was successfully created.' }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>UsersController</td>
    <td>update</td>
    <td>Mass Assignment</td>
    <td><div class='warning_message' onClick="toggle('context31');toggle('message31');toggle('full_message31')" >Unprotected mass assignment near line 70: User.find(params[:id]).update_attributes(<span class="user_input">params[:user]</span>)<table id='context31' class='context' style='display:none'><caption>/app/controllers/users_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>65</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /users/1.json</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @user = User.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @user.update_attributes(params[:user])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @user, notice: 'User was successfully updated.' }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { head :ok }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @user.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ResponsesController</td>
    <td>create</td>
    <td>Redirect</td>
    <td><div class='warning_message' onClick="toggle('context32');toggle('message32');toggle('full_message32')" ><span id='message32' style='display:block' >Possible unprotected redirect near line 49: redirect_to(<span class="user_input">Response.new(params[:response])</span>.request, :not...</span><span id='full_message32' style='display:none'>Possible unprotected redirect near line 49: redirect_to(<span class="user_input">Response.new(params[:response])</span>.request, :notice =&gt; &quot;Response was successfully created.&quot;)</span><table id='context32' class='context' style='display:none'><caption>/app/controllers/responses_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>44</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @response = Response.new(params[:response])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>	@request = Request.where(:id =&gt; params[:response][:request_id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>	logger.debug &quot;@request: #{@request.inspect}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @response.save</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to @response.request, notice: 'Response was successfully created.' }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @response, status: :created, location: @response }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render action: &quot;new&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.json { render json: @response.errors, status: :unprocessable_entity }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td></td>
    <td></td>
    <td>SQL Injection</td>
    <td><div class='warning_message' onClick="toggle('context33');toggle('message33');toggle('full_message33')" ><span id='message33' style='display:block' >All versions of Rails before 3.0.13, 3.1.5, and 3.2.5 contain a SQL Query Generation Vulnerability: C...</span><span id='full_message33' style='display:none'>All versions of Rails before 3.0.13, 3.1.5, and 3.2.5 contain a SQL Query Generation Vulnerability: CVE-2012-2660; Upgrade to 3.2.5, 3.1.5, 3.0.13</span><table id='context33' class='context' style='display:none'><caption>/Gemfile</caption></table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td></td>
    <td></td>
    <td>SQL Injection</td>
    <td><div class='warning_message' onClick="toggle('context34');toggle('message34');toggle('full_message34')" ><span id='message34' style='display:block' >All versions of Rails before 3.0.13, 3.1.5, and 3.2.5 contain a SQL Injection Vulnerability: CVE-2012...</span><span id='full_message34' style='display:none'>All versions of Rails before 3.0.13, 3.1.5, and 3.2.5 contain a SQL Injection Vulnerability: CVE-2012-2661; Upgrade to 3.2.5, 3.1.5, 3.0.13</span><table id='context34' class='context' style='display:none'><caption>/Gemfile</caption></table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td></td>
    <td></td>
    <td>SQL Injection</td>
    <td><div class='warning_message' onClick="toggle('context35');toggle('message35');toggle('full_message35')" ><span id='message35' style='display:block' >All versions of Rails before 3.0.14, 3.1.6, and 3.2.6 contain SQL Injection Vulnerabilities: CVE-2012...</span><span id='full_message35' style='display:none'>All versions of Rails before 3.0.14, 3.1.6, and 3.2.6 contain SQL Injection Vulnerabilities: CVE-2012-2694 and CVE-2012-2695; Upgrade to 3.2.6, 3.1.6, 3.0.14</span><table id='context35' class='context' style='display:none'><caption>/Gemfile</caption></table></div></td>
  </tr>
  

</table><p>Model Warnings</p>
<table>
  <tr>
    <th>Confidence</th>
    <th>Model</th>
    <th>Warning Type</th>
    <th>Message</th>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>Ckeditor::Asset, Ckeditor::AttachmentFile, Ckeditor::Picture, Comment, Course, Portfolio, Project, Proposal, ProposalStatus, ProposalType, Request, Resource, Response, Student, Subject, Teacher, User</td>
    <td>Attribute Restriction</td>
    <td>Mass assignment is not restricted using attr_accessible</td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>User</td>
    <td>Format Validation</td>
    <td><div class='warning_message' onClick="toggle('context36');toggle('message36');toggle('full_message36')" >Insufficient validation for 'username' using /^[-\w\._@]+$/i. Use \A and \z as anchors near line 19<table id='context36' class='context' style='display:none'><caption>/app/models/user.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>14</pre>
          </td>
          <td class='context'>
            <pre class='context'>  accepts_nested_attributes_for :student, :allow_destroy =&gt; true</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>  accepts_nested_attributes_for :teacher, :allow_destroy =&gt; true</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_presence_of :username</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_uniqueness_of :username, :email, :allow_blank =&gt; true</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_format_of :username, :with =&gt; /^[-\w\._@]+$/i, :allow_blank =&gt; true, :message =&gt; &quot;should only contain letters, numbers, or .-_@&quot;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_format_of :email, :with =&gt; /^[-a-z0-9_+\.]+\@([-a-z0-9]+\.)+[a-z0-9]{2,4}$/i</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_presence_of :password, :on =&gt; :create</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_presence_of :role, :on =&gt; :create</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_confirmation_of :password</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_length_of :password, :minimum =&gt; 4, :allow_blank =&gt; true</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>User</td>
    <td>Format Validation</td>
    <td><div class='warning_message' onClick="toggle('context37');toggle('message37');toggle('full_message37')" ><span id='message37' style='display:block' >Insufficient validation for 'email' using /^[-a-z0-9_+\.]+\@([-a-z0-9]+\.)+[a-z0-9]{2,4}$/i. Use \A a...</span><span id='full_message37' style='display:none'>Insufficient validation for 'email' using /^[-a-z0-9_+\.]+\@([-a-z0-9]+\.)+[a-z0-9]{2,4}$/i. Use \A and \z as anchors near line 20</span><table id='context37' class='context' style='display:none'><caption>/app/models/user.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>15</pre>
          </td>
          <td class='context'>
            <pre class='context'>  accepts_nested_attributes_for :teacher, :allow_destroy =&gt; true</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_presence_of :username</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_uniqueness_of :username, :email, :allow_blank =&gt; true</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_format_of :username, :with =&gt; /^[-\w\._@]+$/i, :allow_blank =&gt; true, :message =&gt; &quot;should only contain letters, numbers, or .-_@&quot;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_format_of :email, :with =&gt; /^[-a-z0-9_+\.]+\@([-a-z0-9]+\.)+[a-z0-9]{2,4}$/i</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_presence_of :password, :on =&gt; :create</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_presence_of :role, :on =&gt; :create</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_confirmation_of :password</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_length_of :password, :minimum =&gt; 4, :allow_blank =&gt; true</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_acceptance_of :tos, :accept =&gt; true, :message =&gt; &quot;Yip! We need you to be 13 or older.&quot;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

</table></body></html>